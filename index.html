<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mines Predictor - Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&amp;family=Orbitron:wght@400;700;900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* === CYBERPUNK THEME === */
        :root {
            --bg-color: #0a0e17;
            --glass: rgba(15, 22, 39, 0.9);
            --glass-border: rgba(0, 247, 255, 0.2);
            --neon-blue: #00f7ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff9d;
            --neon-red: #ff0055;
            --neon-yellow: #ffcc00;
            --text: #ffffff;
            --text-muted: #8a9bbd;
            --radius: 16px;
            --font-main: 'Poppins', sans-serif;
            --font-cyber: 'Orbitron', monospace;
            --safe-green: #00ff88;
            --danger-red: #ff3355;
            --warning-orange: #ff9900;
            --selection-yellow: #ffff00;
            --premium-gold: #ffd700;
        }

        body {
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(0, 247, 255, 0.15), transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(255, 0, 255, 0.1), transparent 40%),
                linear-gradient(45deg, rgba(10, 14, 23, 0.9), rgba(20, 25, 40, 0.9));
            color: var(--text);
            font-family: var(--font-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Cyber grid background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0, 247, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 247, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 30px 30px; }
        }

        /* === APP CONTAINER === */
        .app-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            min-height: 100vh;
        }

        /* === CYBER HEADER === */
        .cyber-header {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(10, 15, 30, 0.8);
            border-radius: var(--radius);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .cyber-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), var(--neon-pink), transparent);
            animation: scanline 3s linear infinite;
        }

        @keyframes scanline {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .cyber-header h1 {
            font-family: var(--font-cyber);
            font-size: 1.8rem;
            margin: 0;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 900;
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 15px rgba(0, 247, 255, 0.5);
        }

        .app-name {
            font-size: 1.2rem;
            color: var(--neon-green);
            margin-top: 5px;
            font-family: var(--font-cyber);
        }

        /* === FLOATING WHATSAPP ICONS === */
        .floating-icons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: opacity 0.5s;
        }

        .floating-icons.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .whatsapp-icon {
            width: 50px;
            height: 50px;
            background: #25D366;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.5);
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .whatsapp-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.7);
        }

        .whatsapp-icon.channel {
            background: linear-gradient(45deg, #ff00ff, #00f7ff);
        }

        /* === MAIN MENU === */
        .main-menu {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }

        .menu-card {
            background: rgba(15, 22, 39, 0.9);
            border-radius: var(--radius);
            padding: 25px;
            border: 1px solid var(--glass-border);
            text-align: center;
            backdrop-filter: blur(5px);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 247, 255, 0.2);
        }

        .menu-card.free {
            border-color: var(--neon-green);
        }

        .menu-card.premium {
            border-color: var(--premium-gold);
        }

        .menu-card.payment {
            border-color: var(--neon-blue);
        }

        .menu-card.reseller {
            border-color: var(--neon-pink);
        }

        .menu-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .menu-card.free .menu-icon {
            color: var(--neon-green);
        }

        .menu-card.premium .menu-icon {
            color: var(--premium-gold);
        }

        .menu-card.payment .menu-icon {
            color: var(--neon-blue);
        }

        .menu-card.reseller .menu-icon {
            color: var(--neon-pink);
        }

        .menu-title {
            font-family: var(--font-cyber);
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--text);
        }

        .menu-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .menu-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .free-badge {
            background: var(--neon-green);
            color: black;
        }

        .premium-badge {
            background: var(--premium-gold);
            color: black;
        }

        /* === FORM STYLES === */
        .form-container {
            background: rgba(15, 22, 39, 0.9);
            border-radius: var(--radius);
            padding: 25px;
            border: 1px solid var(--glass-border);
            margin-top: 20px;
            backdrop-filter: blur(5px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--neon-blue);
            font-family: var(--font-cyber);
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--glass-border);
            border-radius: 8px;
            color: white;
            font-family: var(--font-main);
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--neon-blue);
        }

        /* === BUTTONS === */
        .cyber-btn {
            padding: 15px 30px;
            border-radius: var(--radius);
            font-family: var(--font-cyber);
            font-weight: 700;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
            margin-top: 10px;
        }

        .cyber-btn.primary {
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-green));
            color: black;
        }

        .cyber-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid var(--glass-border);
        }

        .cyber-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 247, 255, 0.3);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(15, 22, 39, 0.9);
            border: 1px solid var(--glass-border);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        /* === GAME STYLES (Same as before) === */
        .cyber-section {
            background: rgba(15, 22, 39, 0.9);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .section-title {
            font-family: var(--font-cyber);
            font-size: 1rem;
            color: var(--neon-blue);
            font-weight: 600;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            display: inline-block;
        }

        .cyber-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            position: relative;
            z-index: 1;
        }

        .cyber-btn.bomb-btn {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--danger-red);
            color: white;
            padding: 18px 5px;
            font-size: 1.2rem;
        }

        .cyber-btn.bomb-btn.safe-bomb {
            border-color: var(--safe-green);
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }

        .cyber-btn.bomb-btn.high-risk {
            border-color: var(--danger-red);
            box-shadow: 0 0 10px rgba(255, 51, 85, 0.3);
        }

        .cyber-btn.bomb-btn.selected {
            border-color: var(--selection-yellow);
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
        }

        .cyber-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 350px;
        }

        .grid-cell {
            aspect-ratio: 1;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-cyber);
            font-weight: 700;
            font-size: 1.4rem;
            cursor: pointer;
            border: 2px solid rgba(0, 247, 255, 0.2);
            transition: all 0.5s;
        }

        .grid-cell.revealed {
            animation: flipReveal 0.6s ease-out forwards;
        }

        @keyframes flipReveal {
            0% { transform: rotateY(0deg) scale(1); }
            50% { transform: rotateY(90deg) scale(0.9); }
            100% { transform: rotateY(0deg) scale(1); }
        }

        .grid-cell.mine {
            background: rgba(255, 0, 85, 0.3);
            border-color: var(--neon-red);
            color: white;
        }

        .grid-cell.safe {
            background: rgba(0, 255, 157, 0.2);
            border-color: var(--neon-green);
            color: white;
        }

        .grid-cell.recommended::after {
            content: '‚ú∞';
            position: absolute;
            top: -20px;
            right: -10px;
            font-size: 1.2rem;
            animation: firePulse 1s infinite alternate;
            filter: drop-shadow(0 0 5px orange);
            z-index: 2;
        }

        .grid-cell.best-choice {
            background: linear-gradient(45deg, rgba(0, 255, 157, 0.3), rgba(0, 247, 255, 0.3));
            border-color: var(--neon-yellow);
            box-shadow: 0 0 25px rgba(255, 204, 0, 0.4);
        }

        .prediction-panel {
            min-height: 100px;
            background: rgba(15, 22, 39, 0.9);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 25px;
            backdrop-filter: blur(5px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid var(--glass-border);
        }

        .stat-value {
            font-family: var(--font-cyber);
            color: var(--neon-blue);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .action-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(10, 14, 23, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        /* === NOTIFICATION === */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--neon-green);
            color: black;
            padding: 12px 25px;
            border-radius: 30px;
            font-family: var(--font-cyber);
            font-weight: 700;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            z-index: 2000;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .notification.show {
            opacity: 1;
            top: 20px;
        }

        /* === RESPONSIVE === */
        @media (min-width: 768px) {
            .app-container {
                max-width: 500px;
                padding: 25px;
            }
        }

        /* === PREMIUM BADGE === */
        .premium-user-badge {
            position: fixed;
            top: 20px;
            left: 70px;
            background: linear-gradient(45deg, var(--premium-gold), #ff9500);
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
            font-family: var(--font-cyber);
            font-size: 0.8rem;
            font-weight: bold;
            z-index: 999;
        }

        /* === PAYMENT FORM === */
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .payment-method {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--glass-border);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-method.selected {
            border-color: var(--neon-green);
            background: rgba(0, 255, 157, 0.1);
        }

        .payment-method i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--neon-blue);
        }
    </style>
</head>
<body>
    <!-- Floating WhatsApp Icons -->
    <div class="floating-icons" id="floatingIcons">
        <a href="https://wa.me/255000000000" target="_blank" class="whatsapp-icon" id="adminWhatsapp">
            <i class="fab fa-whatsapp"></i>
        </a>
        <a href="https://whatsapp.com/channel/0029Vb72cVkJ3jv10gzqTn18" target="_blank" class="whatsapp-icon channel">
            <i class="fab fa-whatsapp"></i>
        </a>
    </div>

    <!-- Back Button -->
    <div class="back-btn" id="backBtn" style="display: none;">
        <i class="fas fa-arrow-left"></i>
    </div>

    <!-- Premium Badge -->
    <div class="premium-user-badge" id="premiumBadge" style="display: none;">
        <i class="fas fa-crown"></i> PREMIUM
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="cyber-loader"></div>
        <div class="loading-text" id="loadingText">ANALYZING PATTERNS</div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- App Container -->
    <div class="app-container" id="appContainer">
        <!-- Main Menu (Default View) -->
        <div id="mainMenu">
            <div class="cyber-header">
                <h1 id="appTitle">MINES PREDICTOR</h1>
                <div class="app-name" id="dynamicAppName">Premium Predictor</div>
            </div>

            <div class="main-menu">
                <div class="menu-card free" onclick="showFreeTrial()">
                    <div class="menu-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <div class="menu-title">FREE TRIAL</div>
                    <div class="menu-description">Get 2 free predictions every 24 hours</div>
                    <div class="menu-badge free-badge" id="freeTrialBadge">
                        <i class="fas fa-clock"></i> 2 LEFT TODAY
                    </div>
                </div>

                <div class="menu-card premium" onclick="showPremiumCodeForm()">
                    <div class="menu-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="menu-title">PREMIUM CODE</div>
                    <div class="menu-description">Enter reseller code for unlimited access</div>
                    <div class="menu-badge premium-badge">
                        <i class="fas fa-key"></i> ENTER CODE
                    </div>
                </div>

                <div class="menu-card payment" onclick="showPaymentForm()">
                    <div class="menu-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="menu-title">BUY PREMIUM</div>
                    <div class="menu-description">Purchase premium access directly</div>
                    <div class="menu-badge premium-badge">
                        <i class="fas fa-bolt"></i> INSTANT ACCESS
                    </div>
                </div>

                <div class="menu-card reseller" onclick="showResellerInfo()">
                    <div class="menu-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="menu-title">RESELLER</div>
                    <div class="menu-description">Become a reseller and earn money</div>
                    <div class="menu-badge free-badge">
                        <i class="fas fa-dollar-sign"></i> EARN 50%
                    </div>
                </div>
            </div>
        </div>

        <!-- Free Trial Form -->
        <div id="freeTrialForm" style="display: none;">
            <div class="cyber-header">
                <h1>FREE TRIAL</h1>
                <div class="app-name">Limited Access</div>
            </div>

            <div class="form-container">
                <div class="form-group">
                    <div class="stat-item">
                        <div class="stat-value" id="trialCount">2</div>
                        <div class="stat-label">PREDICTIONS LEFT</div>
                    </div>
                </div>

                <div class="form-group">
                    <p style="color: var(--text-muted); text-align: center;">
                        You get <span class="cyber-highlight">2 free predictions</span> every 24 hours.
                        After using your free predictions, you can upgrade to premium.
                    </p>
                </div>

                <button class="cyber-btn primary" onclick="startFreeTrial()">
                    <i class="fas fa-play"></i> START FREE PREDICTION
                </button>

                <button class="cyber-btn secondary" onclick="showMainMenu()">
                    <i class="fas fa-arrow-left"></i> BACK
                </button>
            </div>
        </div>

        <!-- Premium Code Form -->
        <div id="premiumCodeForm" style="display: none;">
            <div class="cyber-header">
                <h1>PREMIUM ACCESS</h1>
                <div class="app-name">Enter Reseller Code</div>
            </div>

            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">RESELLER CODE</label>
                    <input type="text" class="form-input" id="premiumCodeInput" 
                           placeholder="Enter your premium code" maxlength="20">
                </div>

                <div class="form-group">
                    <p style="color: var(--text-muted); font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i> Each code can be used only once per device.
                        Contact your reseller to get a valid code.
                    </p>
                </div>

                <button class="cyber-btn primary" onclick="validatePremiumCode()">
                    <i class="fas fa-check"></i> ACTIVATE PREMIUM
                </button>

                <button class="cyber-btn secondary" onclick="showMainMenu()">
                    <i class="fas fa-arrow-left"></i> BACK
                </button>
            </div>
        </div>

        <!-- Payment Form -->
        <div id="paymentForm" style="display: none;">
            <div class="cyber-header">
                <h1>BUY PREMIUM</h1>
                <div class="app-name">Instant Access</div>
            </div>

            <div class="form-container">
                <div class="form-group">
                    <label class="form-label">SELECT DURATION</label>
                    <select class="form-input" id="durationSelect">
                        <option value="7">7 Days - TZS 5,000</option>
                        <option value="30">30 Days - TZS 15,000</option>
                        <option value="90">90 Days - TZS 35,000</option>
                        <option value="365">1 Year - TZS 100,000</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">PHONE NUMBER</label>
                    <input type="tel" class="form-input" id="phoneNumber" 
                           placeholder="07XXXXXXXX" maxlength="10">
                </div>

                <div class="form-group">
                    <div class="payment-methods">
                        <div class="payment-method selected" onclick="selectPaymentMethod('harakapay')">
                            <i class="fas fa-mobile-alt"></i>
                            <div>HarakaPay</div>
                            <small>USSD Push</small>
                        </div>
                        <div class="payment-method" onclick="selectPaymentMethod('tigo')">
                            <i class="fas fa-sim-card"></i>
                            <div>Tigo Pesa</div>
                            <small>Coming Soon</small>
                        </div>
                    </div>
                </div>

                <button class="cyber-btn primary" onclick="initiatePayment()">
                    <i class="fas fa-lock"></i> PAY NOW
                </button>

                <button class="cyber-btn secondary" onclick="showMainMenu()">
                    <i class="fas fa-arrow-left"></i> BACK
                </button>
            </div>
        </div>

        <!-- Reseller Info -->
        <div id="resellerInfo" style="display: none;">
            <div class="cyber-header">
                <h1>RESELLER PROGRAM</h1>
                <div class="app-name">Earn 50% Commission</div>
            </div>

            <div class="form-container">
                <div class="form-group">
                    <h3 style="color: var(--neon-green); text-align: center;">
                        <i class="fas fa-money-bill-wave"></i> EARN BIG!
                    </h3>
                    <p style="color: var(--text-muted); text-align: center;">
                        Become a reseller and get 50% commission on every sale!
                    </p>
                </div>

                <div class="form-group">
                    <label class="form-label">CONTACT ADMIN</label>
                    <div style="text-align: center; margin: 20px 0;">
                        <a href="https://wa.me/255000000000" target="_blank" 
                           style="display: inline-block; padding: 15px 30px; 
                                  background: #25D366; color: white; 
                                  border-radius: var(--radius); text-decoration: none;">
                            <i class="fab fa-whatsapp"></i> WhatsApp Admin
                        </a>
                    </div>
                </div>

                <button class="cyber-btn secondary" onclick="showMainMenu()">
                    <i class="fas fa-arrow-left"></i> BACK
                </button>
            </div>
        </div>

        <!-- Game Section -->
        <div id="gameSection" style="display: none;">
            <div class="cyber-header">
                <h1>MINES PREDICTOR</h1>
                <div class="app-name" id="gameMode">PREMIUM MODE</div>
            </div>

            <!-- Bomb Selection -->
            <div class="cyber-section">
                <div class="section-title">BOMB CONFIGURATION</div>
                <div class="cyber-buttons" id="bombSelection"></div>
            </div>

            <!-- Game Grid -->
            <div class="cyber-section game-grid-section">
                <div class="cyber-grid" id="gameGrid"></div>
            </div>

            <!-- Prediction Panel -->
            <div class="prediction-panel">
                <div class="prediction-content">
                    <div class="prediction-title">
                        <i class="fas fa-brain"></i> SERVER ANALYSIS
                        <span class="recommendation-badge">üî¥live</span>
                    </div>
                    <div class="prediction-text" id="predictionDisplay">
                        SELECT <span class="danger-highlight">BOMB</span> COUNT AND START
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="safeCount">?</div>
                            <div class="stat-label">SAFE CELLS</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="bombCount">2</div>
                            <div class="stat-label">BOMBS</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="accuracy">?</div>
                            <div class="stat-label">ACCURACY</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-panel">
                <button class="cyber-btn primary" id="startBtn">
                    <i class="fas fa-rocket"></i> START
                </button>
                <button class="cyber-btn secondary" id="resetBtn">
                    <i class="fas fa-sync-alt"></i> RESET
                </button>
            </div>

            <button class="cyber-btn secondary" onclick="showMainMenu()" style="margin-top: 20px;">
                <i class="fas fa-home"></i> BACK TO MENU
            </button>
        </div>
    </div>

    <script>
        // ==============================
        // GLOBAL VARIABLES
        // ==============================
        const APP_CONFIG = {
            appName: "MINES PREDICTOR",
            adminWhatsapp: "255000000000",
            channelLink: "https://whatsapp.com/channel/0029Vb72cVkJ3jv10gzqTn18",
            harakapayApiKey: "hpk_fb763cc04e2feec29eb19041f75f54d0e6eb0067486caaae",
            baseUrl: "https://harakapay.net",
            prices: {
                7: 5000,
                30: 15000,
                90: 35000,
                365: 100000
            }
        };

        // User State
        const userState = {
            isPremium: false,
            premiumExpiry: null,
            freeTrialsLeft: 2,
            lastTrialDate: null,
            deviceId: null,
            usedCodes: []
        };

        // Game State
        const gameState = {
            active: false,
            bombs: 2,
            mines: [],
            safeCells: [],
            revealed: [],
            gridSize: 25,
            bombOptions: [2, 3, 5, 7],
            recommendations: [],
            bestChoices: [],
            currentGameMode: null // 'free' or 'premium'
        };

        // ==============================
        // INITIALIZATION
        // ==============================
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            setupEventListeners();
            checkFreeTrialStatus();
            checkPremiumStatus();
            updateUI();
        });

        function initApp() {
            // Generate device ID if not exists
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = 'DEV' + Date.now() + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('deviceId', deviceId);
            }
            userState.deviceId = deviceId;

            // Load user state from localStorage
            loadUserState();

            // Update app name from config
            document.getElementById('appTitle').textContent = APP_CONFIG.appName;
            document.getElementById('dynamicAppName').textContent = APP_CONFIG.appName;

            // Update WhatsApp links
            document.getElementById('adminWhatsapp').href = `https://wa.me/${APP_CONFIG.adminWhatsapp}`;
        }

        function loadUserState() {
            const saved = localStorage.getItem('userState');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    userState.isPremium = data.isPremium || false;
                    userState.premiumExpiry = data.premiumExpiry ? new Date(data.premiumExpiry) : null;
                    userState.freeTrialsLeft = data.freeTrialsLeft || 2;
                    userState.lastTrialDate = data.lastTrialDate ? new Date(data.lastTrialDate) : null;
                    userState.usedCodes = data.usedCodes || [];
                } catch (e) {
                    console.error('Error loading user state:', e);
                }
            }
        }

        function saveUserState() {
            localStorage.setItem('userState', JSON.stringify(userState));
        }

        // ==============================
        // FREE TRIAL SYSTEM
        // ==============================
        function checkFreeTrialStatus() {
            const now = new Date();
            
            // Check if 24 hours have passed since last trial
            if (userState.lastTrialDate) {
                const lastTrial = new Date(userState.lastTrialDate);
                const hoursDiff = (now - lastTrial) / (1000 * 60 * 60);
                
                if (hoursDiff >= 24) {
                    // Reset free trials
                    userState.freeTrialsLeft = 2;
                    userState.lastTrialDate = null;
                    saveUserState();
                }
            }

            // Update UI
            document.getElementById('freeTrialBadge').innerHTML = 
                `<i class="fas fa-clock"></i> ${userState.freeTrialsLeft} LEFT TODAY`;
            
            document.getElementById('trialCount').textContent = userState.freeTrialsLeft;
        }

        function startFreeTrial() {
            if (userState.freeTrialsLeft <= 0) {
                showNotification("No free trials left! Wait 24 hours or upgrade to premium.", "error");
                return;
            }

            // Hide floating icons when game starts
            document.getElementById('floatingIcons').classList.add('hidden');

            userState.freeTrialsLeft--;
            userState.lastTrialDate = new Date().toISOString();
            saveUserState();

            gameState.currentGameMode = 'free';
            document.getElementById('gameMode').textContent = "FREE TRIAL";
            
            showGameSection();
            initGame();
        }

        // ==============================
        // PREMIUM SYSTEM
        // ==============================
        function checkPremiumStatus() {
            if (userState.isPremium && userState.premiumExpiry) {
                const now = new Date();
                if (now > new Date(userState.premiumExpiry)) {
                    // Premium expired
                    userState.isPremium = false;
                    userState.premiumExpiry = null;
                    saveUserState();
                    document.getElementById('premiumBadge').style.display = 'none';
                } else {
                    // Still premium
                    document.getElementById('premiumBadge').style.display = 'block';
                }
            } else {
                document.getElementById('premiumBadge').style.display = 'none';
            }
        }

        function validatePremiumCode() {
            const code = document.getElementById('premiumCodeInput').value.trim();
            
            if (!code) {
                showNotification("Please enter a premium code", "error");
                return;
            }

            // Check if code already used on this device
            if (userState.usedCodes.includes(code)) {
                showNotification("This code has already been used on this device", "error");
                return;
            }

            showLoading(true, "Validating code...");

            // In a real app, this would call an API
            // For demo, we'll simulate validation
            setTimeout(() => {
                // Simulate checking with server
                const isValid = Math.random() > 0.3; // 70% success rate for demo
                
                if (isValid) {
                    // Mark code as used
                    userState.usedCodes.push(code);
                    
                    // Activate premium (7 days for demo)
                    const expiryDate = new Date();
                    expiryDate.setDate(expiryDate.getDate() + 7);
                    
                    userState.isPremium = true;
                    userState.premiumExpiry = expiryDate.toISOString();
                    saveUserState();
                    
                    showLoading(false);
                    showNotification("Premium activated successfully! üéâ", "success");
                    
                    // Hide floating icons
                    document.getElementById('floatingIcons').classList.add('hidden');
                    
                    // Start game in premium mode
                    gameState.currentGameMode = 'premium';
                    document.getElementById('gameMode').textContent = "PREMIUM MODE";
                    document.getElementById('premiumBadge').style.display = 'block';
                    
                    showGameSection();
                    initGame();
                } else {
                    showLoading(false);
                    showNotification("Invalid premium code. Please check and try again.", "error");
                }
            }, 1500);
        }

        // ==============================
        // PAYMENT SYSTEM
        // ==============================
        let selectedPaymentMethod = 'harakapay';

        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            document.querySelectorAll('.payment-method').forEach(el => {
                el.classList.remove('selected');
            });
            event.target.closest('.payment-method').classList.add('selected');
        }

        function initiatePayment() {
            const phone = document.getElementById('phoneNumber').value.trim();
            const duration = parseInt(document.getElementById('durationSelect').value);
            const amount = APP_CONFIG.prices[duration];

            if (!phone || phone.length !== 10 || !phone.startsWith('07')) {
                showNotification("Please enter a valid phone number (07XXXXXXXX)", "error");
                return;
            }

            showLoading(true, "Initiating payment...");

            // HarakaPay API Integration
            const paymentData = {
                phone: phone,
                amount: amount,
                description: `Premium Access ${duration} days`
            };

            // In a real implementation, this would call your backend
            // For demo, we'll simulate payment
            setTimeout(() => {
                showLoading(false);
                
                // Simulate successful payment
                const orderId = 'HP' + Date.now();
                
                showNotification("USSD push sent to your phone. Complete payment to activate premium.", "info");
                
                // In real app, you would check payment status periodically
                // For demo, we'll auto-activate after 5 seconds
                setTimeout(() => {
                    // Simulate payment confirmation
                    const expiryDate = new Date();
                    expiryDate.setDate(expiryDate.getDate() + duration);
                    
                    userState.isPremium = true;
                    userState.premiumExpiry = expiryDate.toISOString();
                    saveUserState();
                    
                    showNotification("Payment confirmed! Premium activated. üéâ", "success");
                    
                    // Hide floating icons
                    document.getElementById('floatingIcons').classList.add('hidden');
                    
                    // Start game in premium mode
                    gameState.currentGameMode = 'premium';
                    document.getElementById('gameMode').textContent = "PREMIUM MODE";
                    document.getElementById('premiumBadge').style.display = 'block';
                    
                    showGameSection();
                    initGame();
                }, 5000);
            }, 2000);
        }

        // ==============================
        // GAME LOGIC (Original)
        // ==============================
        function initGame() {
            renderBombSelection();
            renderGrid();
            setupGameEventListeners();
            
            // Initialize stats
            document.getElementById('safeCount').textContent = "?";
            document.getElementById('bombCount').textContent = gameState.bombs;
            document.getElementById('accuracy').textContent = "?";
            
            // Show initial message with time
            const currentTime = getFormattedTime();
            updatePrediction(`SELECT BOMB COUNT AND START<br>
            Current time: <span class="cyber-highlight">${currentTime}</span>`);
        }

        function renderBombSelection() {
            const container = document.getElementById('bombSelection');
            container.innerHTML = '';
            
            gameState.bombOptions.forEach(bombCount => {
                const btn = document.createElement('button');
                btn.className = 'cyber-btn bomb-btn';
                
                if (bombCount === 2 || bombCount === 3) {
                    btn.classList.add('safe-bomb');
                } else if (bombCount >= 5) {
                    btn.classList.add('high-risk');
                }
                
                if (bombCount === gameState.bombs) {
                    btn.classList.add('selected');
                }
                
                btn.textContent = bombCount;
                btn.onclick = () => selectBombs(bombCount);
                container.appendChild(btn);
            });
        }

        function renderGrid() {
            const grid = document.getElementById('gameGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < gameState.gridSize; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                cell.dataset.index = i;
                cell.textContent = '?';
                grid.appendChild(cell);
            }
        }

        function setupGameEventListeners() {
            document.getElementById('startBtn').onclick = startGame;
            document.getElementById('resetBtn').onclick = resetGame;
        }

        function selectBombs(count) {
            gameState.bombs = count;
            renderBombSelection();
            
            document.getElementById('bombCount').textContent = count;
            document.getElementById('safeCount').textContent = "?";
            document.getElementById('accuracy').textContent = "?";
            
            const currentTime = getFormattedTime();
            
            if (count >= 5) {
                updatePrediction(`‚ö†Ô∏è <span class="danger-highlight">HIGH RISK WARNING!</span> ‚ö†Ô∏è<br>
                ${count} BOMBS DETECTED - DANGER!<br>
                Survival probability: <span class="danger-highlight">${Math.round((25-count)/25*100)}%</span><br>
                Current time: <span class="cyber-highlight">${currentTime}</span><br>
                <span class="cyber-highlight">Advice: Choose lower bomb (2-3) for better odds</span>`);
            } else {
                updatePrediction(`BOMBS SET TO: ${count}. READY FOR ANALYSIS.<br>
                Current time: <span class="cyber-highlight">${currentTime}</span>`);
            }
        }

        async function startGame() {
            if (gameState.active) {
                showNotification("ANALYSIS ALREADY IN PROGRESS", "warning");
                return;
            }

            showLoading(true, "GENERATING MINEFIELD");
            
            // Reset game state
            gameState.active = true;
            gameState.mines = [];
            gameState.safeCells = [];
            gameState.revealed = [];
            gameState.recommendations = [];
            gameState.bestChoices = [];

            // Generate mines
            const positions = Array.from({length: gameState.gridSize}, (_, i) => i);
            for (let i = 0; i < gameState.bombs; i++) {
                const randomIndex = Math.floor(Math.random() * positions.length);
                gameState.mines.push(positions[randomIndex]);
                positions.splice(randomIndex, 1);
            }

            // Generate safe cells to reveal
            const totalSafe = gameState.gridSize - gameState.bombs;
            const cellsToReveal = Math.floor(totalSafe * (0.4 + Math.random() * 0.2));
            
            for (let i = 0; i < cellsToReveal; i++) {
                const safePositions = positions.filter(p => !gameState.mines.includes(p));
                if (safePositions.length === 0) break;
                
                const randomIndex = Math.floor(Math.random() * safePositions.length);
                const safeCell = safePositions[randomIndex];
                gameState.revealed.push(safeCell);
                positions.splice(positions.indexOf(safeCell), 1);
            }

            // Calculate recommendations
            calculateRecommendations();

            // For high-risk games, only show safest cell
            if (gameState.bombs >= 5) {
                gameState.recommendations = gameState.bestChoices.slice(0, 1);
            }

            await sleep(600);
            showLoading(false);
            await animateGridReveal();
        }

        function resetGame() {
            gameState.active = false;
            gameState.mines = [];
            gameState.safeCells = [];
            gameState.revealed = [];
            gameState.recommendations = [];
            gameState.bestChoices = [];

            document.getElementById('safeCount').textContent = "?";
            document.getElementById('bombCount').textContent = gameState.bombs;
            document.getElementById('accuracy').textContent = "?";

            document.querySelectorAll('.grid-cell').forEach((cell, index) => {
                cell.className = 'grid-cell';
                cell.textContent = '?';
                setTimeout(() => {
                    cell.style.opacity = '0.5';
                    setTimeout(() => {
                        cell.style.opacity = '1';
                    }, 100);
                }, index * 20);
            });

            const currentTime = getFormattedTime();
            updatePrediction(`SYSTEM RESET. SELECT BOMBS AND START ANALYSIS.<br>
            Current time: <span class="cyber-highlight">${currentTime}</span>`);
            showNotification("SYSTEM RESET", "info");
        }

        function calculateRecommendations() {
            const allCells = Array.from({length: gameState.gridSize}, (_, i) => i);
            const unrevealedSafe = allCells.filter(i => 
                !gameState.mines.includes(i) && 
                !gameState.revealed.includes(i)
            );

            const scores = unrevealedSafe.map(index => {
                const neighbors = getNeighbors(index);
                const mineNeighbors = neighbors.filter(n => gameState.mines.includes(n));
                const safeNeighbors = neighbors.filter(n => 
                    !gameState.mines.includes(n) && gameState.revealed.includes(n)
                );
                
                let score = 100;
                score -= mineNeighbors.length * 30;
                score += safeNeighbors.length * 15;
                
                const row = Math.floor(index / 5);
                const col = index % 5;
                if ((row === 0 || row === 4) && (col === 0 || col === 4)) {
                    score += 10;
                }
                
                return { index, score };
            });

            scores.sort((a, b) => b.score - a.score);
            const numRecommendations = Math.min(3, scores.length);
            gameState.recommendations = scores.slice(0, numRecommendations).map(s => s.index);

            if (scores.length > 0) {
                gameState.bestChoices = [scores[0].index];
            }
        }

        function getNeighbors(index) {
            const neighbors = [];
            const row = Math.floor(index / 5);
            const col = index % 5;
            
            for (let r = row - 1; r <= row + 1; r++) {
                for (let c = col - 1; c <= col + 1; c++) {
                    if (r >= 0 && r < 5 && c >= 0 && c < 5 && !(r === row && c === col)) {
                        neighbors.push(r * 5 + c);
                    }
                }
            }
            return neighbors;
        }

        async function animateGridReveal() {
            const cells = document.querySelectorAll('.grid-cell');
            
            for (let i = 0; i < cells.length; i++) {
                const cell = cells[i];
                
                if (gameState.mines.includes(i)) {
                    cell.classList.add('mine', 'revealed');
                    cell.textContent = 'üí£';
                } else {
                    cell.classList.add('safe', 'revealed');
                    cell.textContent = 'üíé';
                }
                
                if (gameState.recommendations.includes(i)) {
                    cell.classList.add('recommended');
                }
                if (gameState.bestChoices.includes(i)) {
                    cell.classList.add('best-choice');
                }

                cell.style.animationDelay = `${i * 0.1}s`;
                cell.classList.add('revealed');
                
                await sleep(50);
            }

            updateStats();
            showNotification("ANALYSIS COMPLETE", "success");
            updatePredictionDisplay();
        }

        function updateStats() {
            document.getElementById('safeCount').textContent = gameState.gridSize - gameState.bombs;
            document.getElementById('bombCount').textContent = gameState.bombs;
            const randomAccuracy = 95 + Math.floor(Math.random() * 6);
            document.getElementById('accuracy').textContent = `${randomAccuracy}%`;
        }

        function updatePrediction(message) {
            const predictionText = message
                .replace(/SAFE/gi, '<span class="cyber-highlight">$&</span>')
                .replace(/BOMB/gi, '<span class="danger-highlight">$&</span>')
                .replace(/\d+/g, '<span class="cyber-highlight">$&</span>');
            
            document.getElementById('predictionDisplay').innerHTML = predictionText;
        }

        function updatePredictionDisplay() {
            if (gameState.recommendations.length > 0) {
                const recNumbers = gameState.recommendations.map(i => i + 1);
                const bestChoice = gameState.bestChoices[0] + 1;
                const currentTime = getFormattedTime();
                
                let prediction = `SCANING <span class="cyber-highlight">COMPLETED</span> THESE ARE YOUR <span class="cyber-highlight">SAFE</span> PICKS FOR THIS ROUND üü¢<br><br>`;
                prediction += `<span style="color: var(--neon-blue); font-size: 0.9rem;">
                    ‚è∞ PREDICTION TIME: <span class="cyber-highlight">${currentTime}</span>
                </span><br>`;
                
                if (gameState.bombs >= 5) {
                    prediction += `<span class="danger-highlight">‚ö†Ô∏è HIGH RISK GAME ‚ö†Ô∏è</span><br>`;
                    prediction += `With ${gameState.bombs} bombs, survival chance: <span class="danger-highlight">${Math.round((25-gameState.bombs)/25*100)}%</span><br><br>`;
                    prediction += `<span class="cyber-highlight">SAFEST SINGLE CELL: ${recNumbers[0]}</span><br>`;
                    prediction += `Advice: <span class="danger-highlight">Play only 2 rounds</span>`;
                } else {
                    prediction += `TOP RECOMMENDATIONS: <span class="cyber-highlight">${recNumbers.join(', ')}</span><br>`;
                    prediction += `BEST CHOICE: <span class="cyber-highlight">${bestChoice}</span> (LOWEST RISK)<br><br>`;
                    prediction += `<span class="danger-highlight">${gameState.mines.length} BOMBS</span> DETECTED IN GRID`;
                }
                
                document.getElementById('predictionDisplay').innerHTML = prediction;
            }
        }

        // ==============================
        // UI NAVIGATION
        // ==============================
        function showMainMenu() {
            // Show all sections in main menu
            document.getElementById('mainMenu').style.display = 'block';
            
            // Hide other sections
            document.getElementById('freeTrialForm').style.display = 'none';
            document.getElementById('premiumCodeForm').style.display = 'none';
            document.getElementById('paymentForm').style.display = 'none';
            document.getElementById('resellerInfo').style.display = 'none';
            document.getElementById('gameSection').style.display = 'none';
            
            // Show floating icons again
            document.getElementById('floatingIcons').classList.remove('hidden');
            
            // Hide back button
            document.getElementById('backBtn').style.display = 'none';
            
            // Update free trial badge
            checkFreeTrialStatus();
            checkPremiumStatus();
        }

        function showFreeTrial() {
            hideAllSections();
            document.getElementById('freeTrialForm').style.display = 'block';
            document.getElementById('backBtn').style.display = 'flex';
        }

        function showPremiumCodeForm() {
            hideAllSections();
            document.getElementById('premiumCodeForm').style.display = 'block';
            document.getElementById('backBtn').style.display = 'flex';
        }

        function showPaymentForm() {
            hideAllSections();
            document.getElementById('paymentForm').style.display = 'block';
            document.getElementById('backBtn').style.display = 'flex';
        }

        function showResellerInfo() {
            hideAllSections();
            document.getElementById('resellerInfo').style.display = 'block';
            document.getElementById('backBtn').style.display = 'flex';
        }

        function showGameSection() {
            hideAllSections();
            document.getElementById('gameSection').style.display = 'block';
            document.getElementById('backBtn').style.display = 'flex';
        }

        function hideAllSections() {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('freeTrialForm').style.display = 'none';
            document.getElementById('premiumCodeForm').style.display = 'none';
            document.getElementById('paymentForm').style.display = 'none';
            document.getElementById('resellerInfo').style.display = 'none';
            document.getElementById('gameSection').style.display = 'none';
        }

        // ==============================
        // UTILITY FUNCTIONS
        // ==============================
        function getFormattedTime() {
            const now = new Date();
            let hours = now.getHours();
            let minutes = now.getMinutes();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            
            hours = hours % 12;
            hours = hours ? hours : 12;
            minutes = minutes < 10 ? '0' + minutes : minutes;
            
            return `${hours}:${minutes} ${ampm}`;
        }

        function showLoading(show, text = "Loading...") {
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            
            loadingText.textContent = text;
            
            if (show) {
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }

        function showNotification(message, type = "info") {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // Set color based on type
            if (type === 'success') {
                notification.style.background = 'var(--neon-green)';
                notification.style.color = 'black';
            } else if (type === 'error') {
                notification.style.background = 'var(--neon-red)';
                notification.style.color = 'white';
            } else if (type === 'warning') {
                notification.style.background = 'var(--neon-yellow)';
                notification.style.color = 'black';
            } else {
                notification.style.background = 'var(--neon-blue)';
                notification.style.color = 'black';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function setupEventListeners() {
            document.getElementById('backBtn').onclick = showMainMenu;
            
            // Update floating icons on page visibility
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    document.getElementById('floatingIcons').classList.add('hidden');
                } else {
                    // Only show if on main menu
                    if (document.getElementById('mainMenu').style.display !== 'none') {
                        document.getElementById('floatingIcons').classList.remove('hidden');
                    }
                }
            });
        }

        function updateUI() {
            // Update free trial count
            document.getElementById('freeTrialBadge').innerHTML = 
                `<i class="fas fa-clock"></i> ${userState.freeTrialsLeft} LEFT TODAY`;
            
            document.getElementById('trialCount').textContent = userState.freeTrialsLeft;
            
            // Show/hide premium badge
            checkPremiumStatus();
        }

        // Initialize app name from localStorage if exists
        const savedAppName = localStorage.getItem('appName');
        if (savedAppName) {
            APP_CONFIG.appName = savedAppName;
            document.getElementById('appTitle').textContent = savedAppName;
            document.getElementById('dynamicAppName').textContent = savedAppName;
        }
    </script>
</body>
</html>
